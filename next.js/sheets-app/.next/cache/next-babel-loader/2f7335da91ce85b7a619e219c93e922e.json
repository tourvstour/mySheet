{"ast":null,"code":"import _Table from \"antd/lib/table\";\nimport _Col from \"antd/lib/col\";\nimport _Card from \"antd/lib/card\";\nimport _Button from \"antd/lib/button\";\nimport _Promise from \"@babel/runtime-corejs2/core-js/promise\";\nimport _message from \"antd/lib/message\";\nimport _defineProperty from \"@babel/runtime-corejs2/helpers/esm/defineProperty\";\nimport _Select from \"antd/lib/select\";\nvar __jsx = React.createElement;\nimport React, { Component } from 'react';\nimport readXlsxFile from 'read-excel-file';\nimport { Payback, TranSport } from '../apis/datas';\nimport 'antd/dist/antd.css';\nimport CheckLogin from '../components/CheckLogin';\nimport { withCookies } from 'react-cookie';\nimport ExportExcel from './ExporotExcel';\nconst {\n  Option\n} = _Select;\nconst columns = [{\n  title: 'วันที่',\n  dataIndex: 'dates',\n  key: 'dates',\n  width: 100\n}, {\n  title: 'เลขพัสดุ',\n  dataIndex: 'number',\n  key: 'number',\n  width: 150\n}, {\n  title: 'ราคาสินค้า\t',\n  dataIndex: 'price',\n  key: 'price',\n  width: 100\n}, {\n  title: 'ชื่อลูกค้า',\n  dataIndex: 'customer',\n  key: 'customer',\n  width: 150\n}, {\n  title: 'ที่อยู่จัดส่งพัสดุ',\n  dataIndex: 'address',\n  key: 'address',\n  width: 250\n}, {\n  title: 'รหัสไปรษณี',\n  dataIndex: 'post',\n  key: 'post',\n  width: 100\n}, {\n  title: 'เบอร์ติดต่อ',\n  dataIndex: 'phone',\n  key: 'phone',\n  width: 150\n}];\n\nclass CodPayBack extends Component {\n  constructor() {\n    super();\n\n    _defineProperty(this, \"importExcel\", () => {\n      const input = document.getElementById('file');\n      let result = [];\n      readXlsxFile(input.files[0], {}).then(res => {\n        res.forEach(arr => {\n          let arr0 = new Date(arr[0]).toLocaleDateString(),\n              arr1 = arr[1],\n              arr2 = arr[2].toLocaleString('en-US', {\n            minimumFractionDigits: 2\n          }),\n              arr3 = arr[3],\n              arr4 = arr[4],\n              arr5 = arr[5],\n              arr6 = arr[6];\n          result.push({\n            dates: arr0.toString(),\n            number: arr1,\n            price: arr2,\n            customer: arr3,\n            address: arr4,\n            post: arr5,\n            phone: arr6\n          });\n        });\n        var fill = result.filter(result => {\n          return result.number !== \"เลขพัสดุ\";\n        });\n        console.log(fill);\n        this.setState({\n          file: fill\n        });\n      });\n    });\n\n    _defineProperty(this, \"Upload\", () => {\n      const {\n        cookies\n      } = this.props;\n      let user = cookies.get('userNumber'),\n          store = cookies.get('storeNumber'),\n          excel = this.state.file,\n          transport_comp = this.state.transportSelect.toString();\n\n      _message.loading('upload...', 2).then(() => {\n        if (excel.length > 0) {\n          new _Promise((resolve, rejects) => {\n            var a = Payback(user, transport_comp, excel, store);\n            resolve(a);\n          }).then(res => {\n            let code = res.code,\n                mess = res.message;\n            console.log(code);\n\n            if (code === '1') {\n              _message.success(mess, 2).then(() => {\n                document.getElementById('file').value = null;\n                this.setState({\n                  file: []\n                });\n              });\n            } else {\n              _message.error('error', 2);\n            }\n          }).catch(err => {\n            console.log(err);\n          });\n        } else {\n          _message.warning('ไม่พบข้อมูล', 2);\n        }\n      });\n    });\n\n    _defineProperty(this, \"TranSportSelect\", value => {\n      //console.log(value)\n      if (value > 0) {\n        this.setState({\n          transportSelect: value,\n          buttonUpload: false\n        });\n      } else {\n        this.setState({\n          buttonUpload: true\n        });\n      }\n    });\n\n    this.state = {\n      file: [],\n      tranSportList: [],\n      transportSelect: [],\n      buttonUpload: true\n    };\n  }\n\n  componentDidMount() {\n    new _Promise((resolve, rejects) => {\n      resolve(TranSport());\n    }).then(res => {\n      this.setState({\n        tranSportList: res\n      });\n    });\n  }\n\n  render() {\n    return __jsx(\"div\", {\n      style: {\n        padding: \"2.7% 0 0 0\"\n      }\n    }, __jsx(CheckLogin, null), __jsx(\"div\", {\n      style: {\n        backgroundColor: \"#f7f7f7\",\n        width: \"100%\",\n        height: \"100%\",\n        position: \"absolute\"\n      }\n    }, __jsx(\"br\", null), __jsx(_Col, {\n      lg: {\n        span: 6,\n        offset: 2\n      }\n    }, __jsx(_Card, {\n      style: {\n        boxShadow: \"0 3px 6px 0 rgba(0, 0, 0, 0.2)\"\n      }\n    }, __jsx(\"div\", {\n      style: {\n        textAlign: \"center\"\n      }\n    }, \"\\u0E2D\\u0E31\\u0E1E\\u0E42\\u0E2B\\u0E25\\u0E14 shoping payback\"), __jsx(\"br\", null), __jsx(\"input\", {\n      type: \"file\",\n      id: \"file\",\n      onChange: this.importExcel,\n      style: {\n        width: 180\n      }\n    }), __jsx(\"br\", null), __jsx(\"br\", null), __jsx(\"label\", null, __jsx(\"span\", null, \"\\u0E1A\\u0E23\\u0E34\\u0E29\\u0E31\\u0E17\\u0E02\\u0E19\\u0E2A\\u0E48\\u0E07 : \"), __jsx(_Select, {\n      id: \"transport\",\n      style: {\n        width: 200\n      },\n      onChange: this.TranSportSelect\n    }, this.state.tranSportList.map((data, index) => __jsx(Option, {\n      key: index,\n      value: data.transport_company_number\n    }, data.transport_company_name)))), __jsx(\"br\", null), __jsx(\"br\", null), __jsx(_Button, {\n      block: true,\n      onClick: this.Upload,\n      disabled: this.state.buttonUpload\n    }, \"\\u0E2D\\u0E31\\u0E1E\\u0E42\\u0E2B\\u0E25\\u0E14\\u0E02\\u0E49\\u0E2D\\u0E21\\u0E39\\u0E25\")), __jsx(\"br\", null), __jsx(_Card, {\n      style: {\n        boxShadow: \"0 3px 6px 0 rgba(0, 0, 0, 0.2)\"\n      }\n    }, __jsx(\"label\", null, __jsx(\"span\", null, \"\\u0E02\\u0E31\\u0E49\\u0E19\\u0E15\\u0E2D\\u0E19\\u0E01\\u0E32\\u0E23 Upload File Excel\"), __jsx(ExportExcel, null)))), __jsx(_Col, {\n      lg: {\n        span: 13,\n        offset: 1\n      }\n    }, __jsx(_Table, {\n      style: {\n        boxShadow: \"0 3px 6px 0 rgba(0, 0, 0, 0.2)\"\n      },\n      size: \"small\",\n      columns: columns,\n      dataSource: this.state.file,\n      scroll: {\n        x: 500,\n        y: 500\n      }\n    }))));\n  }\n\n}\n\nexport default withCookies(CodPayBack);","map":null,"metadata":{},"sourceType":"module"}