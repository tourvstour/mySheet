{"ast":null,"code":"import _Table from \"antd/lib/table\";\nimport _Col from \"antd/lib/col\";\nimport _Card from \"antd/lib/card\";\nimport _Button from \"antd/lib/button\";\nimport _Promise from \"@babel/runtime-corejs2/core-js/promise\";\nimport _message from \"antd/lib/message\";\nimport _classCallCheck from \"@babel/runtime-corejs2/helpers/esm/classCallCheck\";\nimport _createClass from \"@babel/runtime-corejs2/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"@babel/runtime-corejs2/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"@babel/runtime-corejs2/helpers/esm/getPrototypeOf\";\nimport _assertThisInitialized from \"@babel/runtime-corejs2/helpers/esm/assertThisInitialized\";\nimport _inherits from \"@babel/runtime-corejs2/helpers/esm/inherits\";\nimport _defineProperty from \"@babel/runtime-corejs2/helpers/esm/defineProperty\";\nimport _Select from \"antd/lib/select\";\nvar _jsxFileName = \"D:\\\\react\\\\webs\\\\next.js\\\\sheets-app\\\\components\\\\CodWaiting.jsx\";\nvar __jsx = React.createElement;\nimport React, { Component } from 'react';\nimport readXlsxFile from 'read-excel-file';\nimport { Upfile, TranSport } from '../apis/datas';\nimport 'antd/dist/antd.css';\nimport CheckLogin from '../components/CheckLogin';\nimport { withCookies } from 'react-cookie';\nimport ExportExcel from './ExporotExcel';\nvar Option = _Select.Option;\nvar columns = [{\n  title: 'วันที่',\n  dataIndex: 'dates',\n  key: 'dates',\n  width: 100\n}, {\n  title: 'เลขพัสดุ',\n  dataIndex: 'number',\n  key: 'number',\n  width: 150\n}, {\n  title: 'ราคาสินค้า\t',\n  dataIndex: 'price',\n  key: 'price',\n  width: 100\n}, {\n  title: 'ชื่อลูกค้า',\n  dataIndex: 'customer',\n  key: 'customer',\n  width: 150\n}, {\n  title: 'ที่อยู่จัดส่งพัสดุ',\n  dataIndex: 'address',\n  key: 'address',\n  width: 250\n}, {\n  title: 'รหัสไปรษณี',\n  dataIndex: 'post',\n  key: 'post',\n  width: 100\n}, {\n  title: 'เบอร์ติดต่อ',\n  dataIndex: 'phone',\n  key: 'phone',\n  width: 150\n}];\n\nvar CodWaiting =\n/*#__PURE__*/\nfunction (_Component) {\n  _inherits(CodWaiting, _Component);\n\n  function CodWaiting() {\n    var _this;\n\n    _classCallCheck(this, CodWaiting);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(CodWaiting).call(this));\n\n    _defineProperty(_assertThisInitialized(_this), \"importExcel\", function () {\n      var input = document.getElementById('file');\n      var result = [];\n      readXlsxFile(input.files[0], {}).then(function (res) {\n        res.forEach(function (arr) {\n          var arr0 = new Date(arr[0]).toLocaleDateString(),\n              arr1 = arr[1],\n              arr2 = arr[2].toLocaleString('en-US', {\n            minimumFractionDigits: 2\n          }),\n              arr3 = arr[3],\n              arr4 = arr[4],\n              arr5 = arr[5],\n              arr6 = arr[6];\n          result.push({\n            dates: arr0.toString(),\n            number: arr1,\n            price: arr2,\n            customer: arr3,\n            address: arr4,\n            post: arr5,\n            phone: arr6\n          });\n        });\n        var fill = result.filter(function (result) {\n          return result.number !== \"เลขพัสดุ\";\n        });\n        console.log(fill);\n\n        _this.setState({\n          file: fill\n        });\n      });\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"Upload\", function () {\n      var cookies = _this.props.cookies;\n\n      var user = cookies.get('userNumber'),\n          store = cookies.get('storeNumber'),\n          excel = _this.state.file,\n          transport_comp = _this.state.transportSelect.toString();\n\n      _message.loading('upload...', 2).then(function () {\n        if (excel.length > 0) {\n          new _Promise(function (resolve, rejects) {\n            var a = Upfile(user, transport_comp, excel, store);\n            resolve(a);\n          }).then(function (res) {\n            var code = res.code,\n                mess = res.message;\n            console.log(code);\n\n            if (code === '1') {\n              _message.success(mess, 2).then(function () {\n                document.getElementById('file').value = null;\n\n                _this.setState({\n                  file: []\n                });\n              });\n            } else {\n              _message.error('error', 2);\n            }\n          })[\"catch\"](function (err) {\n            console.log(err);\n          });\n        } else {\n          _message.warning('ไม่พบข้อมูล', 2);\n        }\n      });\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"TranSportSelect\", function (value) {\n      //console.log(value)\n      if (value > 0) {\n        _this.setState({\n          transportSelect: value,\n          buttonUpload: false\n        });\n      } else {\n        _this.setState({\n          buttonUpload: true\n        });\n      }\n    });\n\n    _this.state = {\n      file: [],\n      tranSportList: [],\n      transportSelect: [],\n      buttonUpload: true\n    };\n    return _this;\n  }\n\n  _createClass(CodWaiting, [{\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      var _this2 = this;\n\n      new _Promise(function (resolve, rejects) {\n        resolve(TranSport());\n      }).then(function (res) {\n        _this2.setState({\n          tranSportList: res\n        });\n      });\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      return __jsx(\"div\", {\n        style: {\n          padding: \"2.7% 0 0 0\"\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 152\n        },\n        __self: this\n      }, __jsx(CheckLogin, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 153\n        },\n        __self: this\n      }), __jsx(\"div\", {\n        style: {\n          backgroundImage: \"url('https://c.wallhere.com/photos/52/24/illustration_rocket_lift_off-875671.jpg!d')\",\n          width: \"100%\",\n          height: \"90%\",\n          padding: \"2% 0 10% 0\",\n          position: \"absolute\"\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 154\n        },\n        __self: this\n      }, __jsx(\"br\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 161\n        },\n        __self: this\n      }), __jsx(_Col, {\n        lg: {\n          span: 6,\n          offset: 2\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 162\n        },\n        __self: this\n      }, __jsx(_Card, {\n        style: {\n          boxShadow: \"0 3px 6px 0 rgba(0, 0, 0, 0.2)\"\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 163\n        },\n        __self: this\n      }, __jsx(\"div\", {\n        style: {\n          textAlign: \"center\"\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 164\n        },\n        __self: this\n      }, \"\\u0E2D\\u0E31\\u0E1E\\u0E42\\u0E2B\\u0E25\\u0E14 COD\"), __jsx(\"input\", {\n        type: \"file\",\n        id: \"file\",\n        onChange: this.importExcel,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 165\n        },\n        __self: this\n      }), __jsx(\"br\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 166\n        },\n        __self: this\n      }), __jsx(\"label\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 167\n        },\n        __self: this\n      }, __jsx(\"span\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 168\n        },\n        __self: this\n      }, \"\\u0E1A\\u0E23\\u0E34\\u0E29\\u0E31\\u0E17\\u0E02\\u0E19\\u0E2A\\u0E48\\u0E07 : \"), __jsx(_Select, {\n        id: \"transport\",\n        style: {\n          width: 200\n        },\n        onChange: this.TranSportSelect,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 169\n        },\n        __self: this\n      }, this.state.tranSportList.map(function (data, index) {\n        return __jsx(Option, {\n          key: index,\n          value: data.transport_company_number,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 175\n          },\n          __self: this\n        }, data.transport_company_name);\n      }))), __jsx(\"br\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 179\n        },\n        __self: this\n      }), __jsx(\"br\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 180\n        },\n        __self: this\n      }), __jsx(_Button, {\n        block: true,\n        onClick: this.Upload,\n        disabled: this.state.buttonUpload,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 181\n        },\n        __self: this\n      }, \"upload\")), __jsx(\"br\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 183\n        },\n        __self: this\n      }), __jsx(_Card, {\n        style: {\n          boxShadow: \"0 3px 6px 0 rgba(0, 0, 0, 0.2)\"\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 184\n        },\n        __self: this\n      }, __jsx(\"label\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 185\n        },\n        __self: this\n      }, __jsx(\"span\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 186\n        },\n        __self: this\n      }, \"\\u0E02\\u0E31\\u0E49\\u0E19\\u0E15\\u0E2D\\u0E19\\u0E01\\u0E32\\u0E23 Upload File Excel\"), __jsx(ExportExcel, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 187\n        },\n        __self: this\n      })))), __jsx(_Col, {\n        lg: {\n          span: 13,\n          offset: 1\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 192\n        },\n        __self: this\n      }, __jsx(_Table, {\n        style: {\n          boxShadow: \"0 3px 6px 0 rgba(0, 0, 0, 0.2)\"\n        },\n        size: \"small\",\n        columns: columns,\n        dataSource: this.state.file,\n        scroll: {\n          x: 500,\n          y: 500\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 193\n        },\n        __self: this\n      }))));\n    }\n  }]);\n\n  return CodWaiting;\n}(Component);\n\nexport default withCookies(CodWaiting);","map":{"version":3,"sources":["D:/react/webs/next.js/sheets-app/components/CodWaiting.jsx"],"names":["React","Component","readXlsxFile","Upfile","TranSport","CheckLogin","withCookies","ExportExcel","Option","columns","title","dataIndex","key","width","CodWaiting","input","document","getElementById","result","files","then","res","forEach","arr","arr0","Date","toLocaleDateString","arr1","arr2","toLocaleString","minimumFractionDigits","arr3","arr4","arr5","arr6","push","dates","toString","number","price","customer","address","post","phone","fill","filter","console","log","setState","file","cookies","props","user","get","store","excel","state","transport_comp","transportSelect","loading","length","resolve","rejects","a","code","mess","message","success","value","error","err","warning","buttonUpload","tranSportList","padding","backgroundImage","height","position","span","offset","boxShadow","textAlign","importExcel","TranSportSelect","map","data","index","transport_company_number","transport_company_name","Upload","x","y"],"mappings":"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","sourcesContent":["import React, { Component } from 'react'\r\nimport readXlsxFile from 'read-excel-file'\r\nimport { Upfile, TranSport } from '../apis/datas'\r\nimport { Button, Col, Select, Card, Table, message } from 'antd'\r\nimport 'antd/dist/antd.css';\r\nimport CheckLogin from '../components/CheckLogin'\r\nimport { withCookies } from 'react-cookie'\r\nimport ExportExcel from './ExporotExcel'\r\nconst { Option } = Select\r\nconst columns = [{\r\n  title: 'วันที่',\r\n  dataIndex: 'dates',\r\n  key: 'dates',\r\n  width: 100\r\n}, {\r\n  title: 'เลขพัสดุ',\r\n  dataIndex: 'number',\r\n  key: 'number',\r\n  width: 150\r\n}, {\r\n  title: 'ราคาสินค้า\t',\r\n  dataIndex: 'price',\r\n  key: 'price',\r\n  width: 100\r\n}, {\r\n  title: 'ชื่อลูกค้า',\r\n  dataIndex: 'customer',\r\n  key: 'customer',\r\n  width: 150\r\n}, {\r\n  title: 'ที่อยู่จัดส่งพัสดุ',\r\n  dataIndex: 'address',\r\n  key: 'address',\r\n  width: 250\r\n}, {\r\n  title: 'รหัสไปรษณี',\r\n  dataIndex: 'post',\r\n  key: 'post',\r\n  width: 100\r\n}, {\r\n  title: 'เบอร์ติดต่อ',\r\n  dataIndex: 'phone',\r\n  key: 'phone',\r\n  width: 150\r\n}]\r\nclass CodWaiting extends Component {\r\n  constructor() {\r\n    super()\r\n    this.state = {\r\n      file: [],\r\n      tranSportList: [],\r\n      transportSelect: [],\r\n      buttonUpload: true\r\n    }\r\n  }\r\n\r\n  componentDidMount() {\r\n    new Promise((resolve, rejects) => {\r\n      resolve(TranSport())\r\n    }).then(res => {\r\n      this.setState({\r\n        tranSportList: res\r\n      })\r\n    })\r\n  }\r\n\r\n  importExcel = () => {\r\n    const input = document.getElementById('file')\r\n    let result = []\r\n    readXlsxFile(input.files[0], {})\r\n      .then(res => {\r\n        res.forEach(arr => {\r\n          let arr0 = new Date(\r\n            arr[0]).toLocaleDateString(),\r\n            arr1 = arr[1],\r\n            arr2 = arr[2].toLocaleString('en-US', { minimumFractionDigits: 2 }),\r\n            arr3 = arr[3],\r\n            arr4 = arr[4],\r\n            arr5 = arr[5],\r\n            arr6 = arr[6]\r\n          result.push({\r\n            dates: arr0.toString(),\r\n            number: arr1,\r\n            price: arr2,\r\n            customer: arr3,\r\n            address: arr4,\r\n            post: arr5,\r\n            phone: arr6\r\n          })\r\n        })\r\n        var fill = result.filter((result) => {\r\n          return result.number !== \"เลขพัสดุ\"\r\n        })\r\n        console.log(fill)\r\n        this.setState({\r\n          file: fill\r\n        })\r\n      })\r\n  }\r\n\r\n  Upload = () => {\r\n    const { cookies } = this.props\r\n    let user = cookies.get('userNumber'),\r\n      store = cookies.get('storeNumber'),\r\n      excel = this.state.file,\r\n      transport_comp = this.state.transportSelect.toString()\r\n    message.loading('upload...', 2)\r\n      .then(() => {\r\n        if (excel.length > 0) {\r\n          new Promise((resolve, rejects) => {\r\n            var a = Upfile(user, transport_comp, excel, store)\r\n            resolve(a)\r\n          }).then(res => {\r\n            let code = res.code,\r\n              mess = res.message\r\n            console.log(code)\r\n            if (code === '1') {\r\n              message.success(mess, 2)\r\n                .then(() => {\r\n                  document.getElementById('file').value = null\r\n                  this.setState({\r\n                    file: []\r\n                  })\r\n                })\r\n            } else {\r\n              message.error('error', 2)\r\n            }\r\n          })\r\n            .catch(err => { console.log(err) })\r\n        } else {\r\n          message.warning('ไม่พบข้อมูล', 2)\r\n        }\r\n      })\r\n  }\r\n\r\n  TranSportSelect = (value) => {\r\n    //console.log(value)\r\n    if (value > 0) {\r\n      this.setState({\r\n        transportSelect: value,\r\n        buttonUpload: false\r\n      })\r\n    } else {\r\n      this.setState({\r\n        buttonUpload: true\r\n      })\r\n    }\r\n  }\r\n\r\n  render() {\r\n    return (\r\n      <div style={{ padding: \"2.7% 0 0 0\" }}>\r\n        <CheckLogin />\r\n        <div style={{\r\n          backgroundImage: \"url('https://c.wallhere.com/photos/52/24/illustration_rocket_lift_off-875671.jpg!d')\",\r\n          width: \"100%\",\r\n          height: \"90%\",\r\n          padding: \"2% 0 10% 0\",\r\n          position: \"absolute\"\r\n        }}>\r\n          <br />\r\n          <Col lg={{ span: 6, offset: 2 }} >\r\n            <Card style={{ boxShadow: \"0 3px 6px 0 rgba(0, 0, 0, 0.2)\" }}>\r\n              <div style={{ textAlign: \"center\" }}>อัพโหลด COD</div>\r\n              <input type=\"file\" id=\"file\" onChange={this.importExcel} />\r\n              <br />\r\n              <label>\r\n                <span>บริษัทขนส่ง : </span>\r\n                <Select\r\n                  id={\"transport\"}\r\n                  style={{ width: 200 }}\r\n                  onChange={this.TranSportSelect}\r\n                >\r\n                  {this.state.tranSportList.map((data, index) => (\r\n                    <Option key={index} value={data.transport_company_number}>{data.transport_company_name}</Option>\r\n                  ))}\r\n                </Select>\r\n              </label>\r\n              <br />\r\n              <br />\r\n              <Button block onClick={this.Upload} disabled={this.state.buttonUpload}>upload</Button>\r\n            </Card>\r\n            <br/>\r\n            <Card style={{ boxShadow: \"0 3px 6px 0 rgba(0, 0, 0, 0.2)\" }}>\r\n              <label>\r\n                <span>ขั้นตอนการ Upload File Excel</span>\r\n                <ExportExcel />\r\n              </label>\r\n            </Card>\r\n          </Col>\r\n\r\n          <Col lg={{ span: 13, offset: 1 }}>\r\n            <Table style={{ boxShadow: \"0 3px 6px 0 rgba(0, 0, 0, 0.2)\" }} size=\"small\" columns={columns} dataSource={this.state.file} scroll={{ x: 500, y: 500 }} />\r\n          </Col>\r\n        </div>\r\n      </div>\r\n    )\r\n  }\r\n}\r\n\r\nexport default withCookies(CodWaiting)\r\n"]},"metadata":{},"sourceType":"module"}