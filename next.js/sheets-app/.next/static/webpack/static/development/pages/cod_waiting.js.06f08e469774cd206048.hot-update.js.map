{"version":3,"file":"static/webpack/static\\development\\pages\\cod_waiting.js.06f08e469774cd206048.hot-update.js","sources":["webpack:///./components/CodWaiting.jsx"],"sourcesContent":["import React, { Component } from 'react'\r\nimport readXlsxFile from 'read-excel-file'\r\nimport { Upfile, TranSport } from '../apis/datas'\r\nimport { Button, Col, Select, Card, Table, message } from 'antd'\r\nimport 'antd/dist/antd.css';\r\nimport CheckLogin from '../components/CheckLogin'\r\nimport { withCookies } from 'react-cookie'\r\nimport ExportExcel from './ExporotExcel'\r\nconst { Option } = Select\r\nconst columns = [{\r\n  title: 'วันที่',\r\n  dataIndex: 'dates',\r\n  key: 'dates',\r\n  width: 100\r\n}, {\r\n  title: 'เลขพัสดุ',\r\n  dataIndex: 'number',\r\n  key: 'number',\r\n  width: 150\r\n}, {\r\n  title: 'ราคาสินค้า\t',\r\n  dataIndex: 'price',\r\n  key: 'price',\r\n  width: 100\r\n}, {\r\n  title: 'ชื่อลูกค้า',\r\n  dataIndex: 'customer',\r\n  key: 'customer',\r\n  width: 150\r\n}, {\r\n  title: 'ที่อยู่จัดส่งพัสดุ',\r\n  dataIndex: 'address',\r\n  key: 'address',\r\n  width: 250\r\n}, {\r\n  title: 'รหัสไปรษณี',\r\n  dataIndex: 'post',\r\n  key: 'post',\r\n  width: 100\r\n}, {\r\n  title: 'เบอร์ติดต่อ',\r\n  dataIndex: 'phone',\r\n  key: 'phone',\r\n  width: 150\r\n}]\r\nclass CodWaiting extends Component {\r\n  constructor() {\r\n    super()\r\n    this.state = {\r\n      file: [],\r\n      tranSportList: [],\r\n      transportSelect: [],\r\n      buttonUpload: true\r\n    }\r\n  }\r\n\r\n  componentDidMount() {\r\n    new Promise((resolve, rejects) => {\r\n      resolve(TranSport())\r\n    }).then(res => {\r\n      this.setState({\r\n        tranSportList: res\r\n      })\r\n    })\r\n  }\r\n\r\n  importExcel = () => {\r\n    const input = document.getElementById('file')\r\n    let result = []\r\n    readXlsxFile(input.files[0], {})\r\n      .then(res => {\r\n        res.forEach(arr => {\r\n          let arr0 = new Date(\r\n            arr[0]).toLocaleDateString(),\r\n            arr1 = arr[1],\r\n            arr2 = arr[2].toLocaleString('en-US', { minimumFractionDigits: 2 }),\r\n            arr3 = arr[3],\r\n            arr4 = arr[4],\r\n            arr5 = arr[5],\r\n            arr6 = arr[6]\r\n          result.push({\r\n            dates: arr0.toString(),\r\n            number: arr1,\r\n            price: arr2,\r\n            customer: arr3,\r\n            address: arr4,\r\n            post: arr5,\r\n            phone: arr6\r\n          })\r\n        })\r\n        var fill = result.filter((result) => {\r\n          return result.number !== \"เลขพัสดุ\"\r\n        })\r\n        console.log(fill)\r\n        this.setState({\r\n          file: fill\r\n        })\r\n      })\r\n  }\r\n\r\n  Upload = () => {\r\n    const { cookies } = this.props\r\n    let user = cookies.get('userNumber'),\r\n      store = cookies.get('storeNumber'),\r\n      excel = this.state.file,\r\n      transport_comp = this.state.transportSelect.toString()\r\n    message.loading('upload...', 2)\r\n      .then(() => {\r\n        if (excel.length > 0) {\r\n          new Promise((resolve, rejects) => {\r\n            var a = Upfile(user, transport_comp, excel, store)\r\n            resolve(a)\r\n          }).then(res => {\r\n            let code = res.code,\r\n              mess = res.message\r\n            console.log(code)\r\n            if (code === '1') {\r\n              message.success(mess, 2)\r\n                .then(() => {\r\n                  document.getElementById('file').value = null\r\n                  this.setState({\r\n                    file: []\r\n                  })\r\n                })\r\n            } else {\r\n              message.error('error', 2)\r\n            }\r\n          })\r\n            .catch(err => { console.log(err) })\r\n        } else {\r\n          message.warning('ไม่พบข้อมูล', 2)\r\n        }\r\n      })\r\n  }\r\n\r\n  TranSportSelect = (value) => {\r\n    //console.log(value)\r\n    if (value > 0) {\r\n      this.setState({\r\n        transportSelect: value,\r\n        buttonUpload: false\r\n      })\r\n    } else {\r\n      this.setState({\r\n        buttonUpload: true\r\n      })\r\n    }\r\n  }\r\n\r\n  render() {\r\n    return (\r\n      <div style={{ padding: \"2.7% 0 0 0\" }}>\r\n        <CheckLogin />\r\n        <div style={{\r\n          backgroundImage: \"url('https://c.wallhere.com/photos/52/24/illustration_rocket_lift_off-875671.jpg!d')\",\r\n          width: \"100%\",\r\n          height: \"90%\",\r\n          padding: \"2% 0 10% 0\",\r\n          position: \"absolute\"\r\n        }}>\r\n          <br />\r\n          <Col lg={{ span: 6, offset: 2 }} >\r\n            <Card style={{ boxShadow: \"0 3px 6px 0 rgba(0, 0, 0, 0.2)\" }}>\r\n              <div style={{ textAlign: \"center\" }}>อัพโหลด COD</div>\r\n              <input type=\"file\" id=\"file\" onChange={this.importExcel} />\r\n              <br />\r\n              <label>\r\n                <span>บริษัทขนส่ง : </span>\r\n                <Select\r\n                  id={\"transport\"}\r\n                  style={{ width: 200 }}\r\n                  onChange={this.TranSportSelect}\r\n                >\r\n                  {this.state.tranSportList.map((data, index) => (\r\n                    <Option key={index} value={data.transport_company_number}>{data.transport_company_name}</Option>\r\n                  ))}\r\n                </Select>\r\n              </label>\r\n              <br />\r\n              <br />\r\n              <Button block onClick={this.Upload} disabled={this.state.buttonUpload}>upload</Button>\r\n            </Card>\r\n            <Card style={{ boxShadow: \"0 3px 6px 0 rgba(0, 0, 0, 0.2)\" }}>\r\n              <label>\r\n                <span>ขั้นตอนการ Upload File Excel</span>\r\n                <ExportExcel />\r\n              </label>\r\n            </Card>\r\n          </Col>\r\n\r\n          <Col lg={{ span: 13, offset: 1 }}>\r\n            <Table style={{ boxShadow: \"0 3px 6px 0 rgba(0, 0, 0, 0.2)\" }} size=\"small\" columns={columns} dataSource={this.state.file} scroll={{ x: 500, y: 500 }} />\r\n          </Col>\r\n        </div>\r\n      </div>\r\n    )\r\n  }\r\n}\r\n\r\nexport default withCookies(CodWaiting)\r\n"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAJA;AAMA;AACA;AACA;AACA;AAJA;AAMA;AACA;AACA;AACA;AAJA;AAMA;AACA;AACA;AACA;AAJA;AAMA;AACA;AACA;AACA;AAJA;AAMA;AACA;AACA;AACA;AAJA;AAMA;AACA;AACA;AACA;AAJA;AACA;AAKA;;;;;AACA;AAAA;AACA;AADA;AACA;AAAA;AACA;AAFA;AAqBA;AACA;AACA;AAEA;AACA;AAAA;AAAA;AAGA;AAAA;AAHA;AAAA;AAAA;AAAA;AAQA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAPA;AASA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AADA;AAGA;AACA;AACA;AArDA;AAsDA;AACA;AACA;AAAA;AAAA;AAAA;AACA;AAGA;AAEA;AACA;AACA;AACA;AACA;AACA;AAAA;AAEA;AACA;AAAA;AACA;AAEA;AACA;AAAA;AACA;AADA;AAGA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AAxFA;AA0FA;AACA;AACA;AACA;AACA;AAFA;AAIA;AACA;AACA;AADA;AAGA;AACA;AACA;AApGA;AACA;AACA;AACA;AACA;AAJA;AAFA;AAQA;AACA;;;AACA;AAAA;AACA;AAAA;AACA;AACA;AACA;AACA;AADA;AAGA;AACA;;;AAqFA;AACA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AALA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAOA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAEA;AACA;AAAA;AAAA;AACA;AAHA;AAAA;AAAA;AAAA;AAAA;AAAA;AAKA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AADA;AAKA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAEA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAKA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAKA;;;;AAvJA;AACA;AAyJA;;;;A","sourceRoot":""}