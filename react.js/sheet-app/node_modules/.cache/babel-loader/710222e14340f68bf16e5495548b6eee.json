{"ast":null,"code":"var _jsxFileName = \"I:\\\\jobs\\\\react.js\\\\sheet-app\\\\src\\\\components\\\\CodWaiting.jsx\";\nimport React, { Component } from 'react';\nimport readXlsxFile from 'read-excel-file';\nimport { Upfile, TranSport } from '../apis/datas';\nimport { Button, Col, Select, Card, Table, message } from 'antd';\nimport { withCookies } from 'react-cookie';\nimport ExportExcel from './ExporotExcel';\nconst Option = Select.Option;\nconst columns = [{\n  title: 'วันที่',\n  dataIndex: 'dates',\n  key: 'dates',\n  width: 100\n}, {\n  title: 'เลขพัสดุ',\n  dataIndex: 'number',\n  key: 'number',\n  width: 150\n}, {\n  title: 'ราคาสินค้า\t',\n  dataIndex: 'price',\n  key: 'price',\n  width: 100\n}, {\n  title: 'ชื่อลูกค้า',\n  dataIndex: 'customer',\n  key: 'customer',\n  width: 150\n}, {\n  title: 'ที่อยู่จัดส่งพัสดุ',\n  dataIndex: 'address',\n  key: 'address',\n  width: 250\n}, {\n  title: 'รหัสไปรษณี',\n  dataIndex: 'post',\n  key: 'post',\n  width: 100\n}, {\n  title: 'เบอร์ติดต่อ',\n  dataIndex: 'phone',\n  key: 'phone',\n  width: 150\n}];\n\nclass CodWaiting extends Component {\n  constructor() {\n    super();\n\n    this.importExcel = () => {\n      const input = document.getElementById('file');\n      let result = [];\n      readXlsxFile(input.files[0], {}).then(res => {\n        res.forEach(arr => {\n          if (arr[0] === null || arr[1] === null || arr[2] === null || arr[3] === null) {\n            //console.log(\"พบข้อผิดพลาดในไฟล์อัพโหลด\")\n            let e = {\n              dates: arr[0],\n              number: arr[1],\n              price: arr[2],\n              customer: arr[3],\n              address: arr[4],\n              post: arr[5],\n              phone: arr[6]\n            };\n            let error = this.state.boxError;\n            console.log(error);\n            error = Object.assign({}, error, e);\n            console.log(error);\n            this.setState({\n              boxError: error\n            });\n          } else {\n            let arr0 = new Date(arr[0]);\n            arr0.setFullYear(arr0.getFullYear() - 543);\n            let a = arr0.toLocaleDateString('th-TH', {\n              year: 'numeric',\n              month: '2-digit',\n              day: '2-digit'\n            });\n            let arr1 = arr[1],\n                arr2 = arr[2].toLocaleString('en-US', {\n              minimumFractionDigits: 2\n            }),\n                arr3 = arr[3],\n                arr4 = arr[4],\n                arr5 = arr[5],\n                arr6 = arr[6];\n            result.push({\n              dates: a.toString(),\n              number: arr1,\n              price: arr2,\n              customer: arr3,\n              address: arr4,\n              post: arr5,\n              phone: arr6\n            });\n          }\n        });\n        var fill = result.filter(result => {\n          return result.number !== \"เลขพัสดุ\";\n        });\n        console.log(fill);\n        console.log(this.state.boxError);\n        this.setState({\n          file: fill\n        });\n      });\n    };\n\n    this.Upload = () => {\n      const cookies = this.props.cookies;\n      let user = cookies.get('userNumber'),\n          store = cookies.get('storeNumber'),\n          excel = this.state.file,\n          transport_comp = this.state.transportSelect.toString();\n      message.loading('upload...', 2).then(() => {\n        if (excel.length > 0) {\n          new Promise((resolve, rejects) => {\n            var a = Upfile(user, transport_comp, excel, store);\n            resolve(a);\n          }).then(res => {\n            let code = res.code,\n                mess = res.message;\n            console.log(code);\n\n            if (code === '1') {\n              message.success(mess, 2).then(() => {\n                document.getElementById('file').value = null;\n                this.setState({\n                  file: []\n                });\n              });\n            } else {\n              message.error('error', 2);\n            }\n          }).catch(err => {\n            console.log(err);\n          });\n        } else {\n          message.warning('ไม่พบข้อมูล', 2);\n        }\n      });\n    };\n\n    this.TranSportSelect = value => {\n      //console.log(value)\n      if (value > 0) {\n        this.setState({\n          transportSelect: value,\n          buttonUpload: false\n        });\n      } else {\n        this.setState({\n          buttonUpload: true\n        });\n      }\n    };\n\n    this.state = {\n      file: [],\n      tranSportList: [],\n      transportSelect: [],\n      buttonUpload: true,\n      boxError: []\n    };\n  }\n\n  componentDidMount() {\n    new Promise((resolve, rejects) => {\n      resolve(TranSport());\n    }).then(res => {\n      this.setState({\n        tranSportList: res\n      });\n    });\n  }\n\n  render() {\n    return React.createElement(\"div\", {\n      style: {\n        padding: \"2.7% 0 0 0\"\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 180\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      style: {\n        backgroundImage: \"url('https://c.wallhere.com/photos/52/24/illustration_rocket_lift_off-875671.jpg!d')\",\n        width: \"100%\",\n        height: \"90%\",\n        padding: \"2% 0 10% 0\",\n        position: \"absolute\"\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 181\n      },\n      __self: this\n    }, React.createElement(\"br\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 188\n      },\n      __self: this\n    }), React.createElement(Col, {\n      lg: {\n        span: 6,\n        offset: 2\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 189\n      },\n      __self: this\n    }, React.createElement(Card, {\n      style: {\n        boxShadow: \"0 3px 6px 0 rgba(0, 0, 0, 0.2)\"\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 190\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      style: {\n        textAlign: \"center\"\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 191\n      },\n      __self: this\n    }, \"\\u0E2D\\u0E31\\u0E1E\\u0E42\\u0E2B\\u0E25\\u0E14 COD\"), React.createElement(\"input\", {\n      type: \"file\",\n      id: \"file\",\n      onChange: this.importExcel,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 192\n      },\n      __self: this\n    }), React.createElement(\"br\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 193\n      },\n      __self: this\n    }), React.createElement(\"label\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 194\n      },\n      __self: this\n    }, React.createElement(\"span\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 195\n      },\n      __self: this\n    }, \"\\u0E1A\\u0E23\\u0E34\\u0E29\\u0E31\\u0E17\\u0E02\\u0E19\\u0E2A\\u0E48\\u0E07 : \"), React.createElement(Select, {\n      id: \"transport\",\n      style: {\n        width: 200\n      },\n      onChange: this.TranSportSelect,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 196\n      },\n      __self: this\n    }, this.state.tranSportList.map((data, index) => React.createElement(Option, {\n      key: index,\n      value: data.transport_company_number,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 202\n      },\n      __self: this\n    }, data.transport_company_name)))), React.createElement(\"br\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 206\n      },\n      __self: this\n    }), React.createElement(\"br\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 207\n      },\n      __self: this\n    }), React.createElement(Button, {\n      block: true,\n      onClick: this.Upload,\n      disabled: this.state.buttonUpload,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 208\n      },\n      __self: this\n    }, \"\\u0E2D\\u0E31\\u0E1E\\u0E42\\u0E2B\\u0E25\\u0E14\\u0E02\\u0E49\\u0E2D\\u0E21\\u0E39\\u0E25\")), React.createElement(\"br\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 210\n      },\n      __self: this\n    }), React.createElement(Card, {\n      style: {\n        boxShadow: \"0 3px 6px 0 rgba(0, 0, 0, 0.2)\"\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 211\n      },\n      __self: this\n    }, React.createElement(\"label\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 212\n      },\n      __self: this\n    }, React.createElement(\"span\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 213\n      },\n      __self: this\n    }, \"\\u0E02\\u0E31\\u0E49\\u0E19\\u0E15\\u0E2D\\u0E19\\u0E01\\u0E32\\u0E23 Upload File Excel\"), React.createElement(ExportExcel, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 214\n      },\n      __self: this\n    })))), React.createElement(Col, {\n      lg: {\n        span: 13,\n        offset: 1\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 219\n      },\n      __self: this\n    }, React.createElement(Table, {\n      style: {\n        boxShadow: \"0 3px 6px 0 rgba(0, 0, 0, 0.2)\"\n      },\n      size: \"small\",\n      columns: columns,\n      dataSource: this.state.file,\n      scroll: {\n        x: 500,\n        y: 500\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 220\n      },\n      __self: this\n    })), React.createElement(Col, {\n      lg: {\n        span: 13,\n        offset: 1\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 222\n      },\n      __self: this\n    }, React.createElement(Table, {\n      style: {\n        boxShadow: \"0 3px 6px 0 rgba(0, 0, 0, 0.2)\"\n      },\n      size: \"small\",\n      columns: columns,\n      dataSource: this.state.boxError,\n      scroll: {\n        x: 500,\n        y: 500\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 223\n      },\n      __self: this\n    }))));\n  }\n\n}\n\nexport default withCookies(CodWaiting);","map":{"version":3,"sources":["I:/jobs/react.js/sheet-app/src/components/CodWaiting.jsx"],"names":["React","Component","readXlsxFile","Upfile","TranSport","Button","Col","Select","Card","Table","message","withCookies","ExportExcel","Option","columns","title","dataIndex","key","width","CodWaiting","constructor","importExcel","input","document","getElementById","result","files","then","res","forEach","arr","e","dates","number","price","customer","address","post","phone","error","state","boxError","console","log","Object","assign","setState","arr0","Date","setFullYear","getFullYear","a","toLocaleDateString","year","month","day","arr1","arr2","toLocaleString","minimumFractionDigits","arr3","arr4","arr5","arr6","push","toString","fill","filter","file","Upload","cookies","props","user","get","store","excel","transport_comp","transportSelect","loading","length","Promise","resolve","rejects","code","mess","success","value","catch","err","warning","TranSportSelect","buttonUpload","tranSportList","componentDidMount","render","padding","backgroundImage","height","position","span","offset","boxShadow","textAlign","map","data","index","transport_company_number","transport_company_name","x","y"],"mappings":"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","sourcesContent":["import React, { Component } from 'react'\r\nimport readXlsxFile from 'read-excel-file'\r\nimport { Upfile, TranSport } from '../apis/datas'\r\nimport { Button, Col, Select, Card, Table, message } from 'antd'\r\nimport { withCookies } from 'react-cookie'\r\nimport ExportExcel from './ExporotExcel'\r\nconst { Option } = Select\r\nconst columns = [{\r\n  title: 'วันที่',\r\n  dataIndex: 'dates',\r\n  key: 'dates',\r\n  width: 100\r\n}, {\r\n  title: 'เลขพัสดุ',\r\n  dataIndex: 'number',\r\n  key: 'number',\r\n  width: 150\r\n}, {\r\n  title: 'ราคาสินค้า\t',\r\n  dataIndex: 'price',\r\n  key: 'price',\r\n  width: 100\r\n}, {\r\n  title: 'ชื่อลูกค้า',\r\n  dataIndex: 'customer',\r\n  key: 'customer',\r\n  width: 150\r\n}, {\r\n  title: 'ที่อยู่จัดส่งพัสดุ',\r\n  dataIndex: 'address',\r\n  key: 'address',\r\n  width: 250\r\n}, {\r\n  title: 'รหัสไปรษณี',\r\n  dataIndex: 'post',\r\n  key: 'post',\r\n  width: 100\r\n}, {\r\n  title: 'เบอร์ติดต่อ',\r\n  dataIndex: 'phone',\r\n  key: 'phone',\r\n  width: 150\r\n}]\r\nclass CodWaiting extends Component {\r\n  constructor() {\r\n    super()\r\n    this.state = {\r\n      file: [],\r\n      tranSportList: [],\r\n      transportSelect: [],\r\n      buttonUpload: true,\r\n      boxError: []\r\n\r\n    }\r\n  }\r\n\r\n  componentDidMount() {\r\n    new Promise((resolve, rejects) => {\r\n      resolve(TranSport())\r\n    }).then(res => {\r\n      this.setState({\r\n        tranSportList: res\r\n      })\r\n    })\r\n  }\r\n\r\n  importExcel = () => {\r\n    const input = document.getElementById('file')\r\n    let result = []\r\n    readXlsxFile(input.files[0], {})\r\n      .then(res => {\r\n        res.forEach(arr => {\r\n          if (arr[0] === null || arr[1] === null || arr[2] === null || arr[3] === null) {\r\n            //console.log(\"พบข้อผิดพลาดในไฟล์อัพโหลด\")\r\n            let e = {\r\n              dates: arr[0],\r\n              number: arr[1],\r\n              price: arr[2],\r\n              customer: arr[3],\r\n              address: arr[4],\r\n              post: arr[5],\r\n              phone: arr[6]\r\n            }\r\n            let error = this.state.boxError\r\n            console.log(error)\r\n            error = Object.assign({}, error, e)\r\n            console.log(error)\r\n            this.setState({\r\n              boxError: error\r\n            })\r\n\r\n          } else {\r\n            let arr0 = new Date(arr[0])\r\n            arr0.setFullYear(arr0.getFullYear() - 543)\r\n            let a = arr0.toLocaleDateString('th-TH', {\r\n              year: 'numeric',\r\n              month: '2-digit',\r\n              day: '2-digit'\r\n            })\r\n            let arr1 = arr[1],\r\n              arr2 = arr[2].toLocaleString('en-US', { minimumFractionDigits: 2 }),\r\n              arr3 = arr[3],\r\n              arr4 = arr[4],\r\n              arr5 = arr[5],\r\n              arr6 = arr[6]\r\n            result.push({\r\n              dates: a.toString(),\r\n              number: arr1,\r\n              price: arr2,\r\n              customer: arr3,\r\n              address: arr4,\r\n              post: arr5,\r\n              phone: arr6\r\n            })\r\n          }\r\n        })\r\n\r\n        var fill = result.filter((result) => {\r\n          return result.number !== \"เลขพัสดุ\"\r\n        })\r\n        console.log(fill)\r\n        console.log(this.state.boxError)\r\n        this.setState({\r\n          file: fill\r\n        })\r\n      })\r\n  }\r\n\r\n  Upload = () => {\r\n    const { cookies } = this.props\r\n    let user = cookies.get('userNumber'),\r\n      store = cookies.get('storeNumber'),\r\n      excel = this.state.file,\r\n      transport_comp = this.state.transportSelect.toString()\r\n    message.loading('upload...', 2)\r\n      .then(() => {\r\n        if (excel.length > 0) {\r\n          new Promise((resolve, rejects) => {\r\n            var a = Upfile(user, transport_comp, excel, store)\r\n            resolve(a)\r\n          }).then(res => {\r\n            let code = res.code,\r\n              mess = res.message\r\n            console.log(code)\r\n            if (code === '1') {\r\n              message.success(mess, 2)\r\n                .then(() => {\r\n                  document.getElementById('file').value = null\r\n                  this.setState({\r\n                    file: []\r\n                  })\r\n                })\r\n            } else {\r\n              message.error('error', 2)\r\n            }\r\n          })\r\n            .catch(err => { console.log(err) })\r\n        } else {\r\n          message.warning('ไม่พบข้อมูล', 2)\r\n        }\r\n      })\r\n  }\r\n\r\n  TranSportSelect = (value) => {\r\n    //console.log(value)\r\n    if (value > 0) {\r\n      this.setState({\r\n        transportSelect: value,\r\n        buttonUpload: false\r\n      })\r\n    } else {\r\n      this.setState({\r\n        buttonUpload: true\r\n      })\r\n    }\r\n  }\r\n\r\n  render() {\r\n    return (\r\n      <div style={{ padding: \"2.7% 0 0 0\" }}>\r\n        <div style={{\r\n          backgroundImage: \"url('https://c.wallhere.com/photos/52/24/illustration_rocket_lift_off-875671.jpg!d')\",\r\n          width: \"100%\",\r\n          height: \"90%\",\r\n          padding: \"2% 0 10% 0\",\r\n          position: \"absolute\"\r\n        }}>\r\n          <br />\r\n          <Col lg={{ span: 6, offset: 2 }} >\r\n            <Card style={{ boxShadow: \"0 3px 6px 0 rgba(0, 0, 0, 0.2)\" }}>\r\n              <div style={{ textAlign: \"center\" }}>อัพโหลด COD</div>\r\n              <input type=\"file\" id=\"file\" onChange={this.importExcel} />\r\n              <br />\r\n              <label>\r\n                <span>บริษัทขนส่ง : </span>\r\n                <Select\r\n                  id={\"transport\"}\r\n                  style={{ width: 200 }}\r\n                  onChange={this.TranSportSelect}\r\n                >\r\n                  {this.state.tranSportList.map((data, index) => (\r\n                    <Option key={index} value={data.transport_company_number}>{data.transport_company_name}</Option>\r\n                  ))}\r\n                </Select>\r\n              </label>\r\n              <br />\r\n              <br />\r\n              <Button block onClick={this.Upload} disabled={this.state.buttonUpload}>อัพโหลดข้อมูล</Button>\r\n            </Card>\r\n            <br />\r\n            <Card style={{ boxShadow: \"0 3px 6px 0 rgba(0, 0, 0, 0.2)\" }}>\r\n              <label>\r\n                <span>ขั้นตอนการ Upload File Excel</span>\r\n                <ExportExcel />\r\n              </label>\r\n            </Card>\r\n          </Col>\r\n\r\n          <Col lg={{ span: 13, offset: 1 }}>\r\n            <Table style={{ boxShadow: \"0 3px 6px 0 rgba(0, 0, 0, 0.2)\" }} size=\"small\" columns={columns} dataSource={this.state.file} scroll={{ x: 500, y: 500 }} />\r\n          </Col>\r\n          <Col lg={{ span: 13, offset: 1 }}>\r\n            <Table style={{ boxShadow: \"0 3px 6px 0 rgba(0, 0, 0, 0.2)\" }} size=\"small\" columns={columns} dataSource={this.state.boxError} scroll={{ x: 500, y: 500 }} />\r\n          </Col>\r\n        </div>\r\n      </div>\r\n    )\r\n  }\r\n}\r\n\r\nexport default withCookies(CodWaiting)\r\n"]},"metadata":{},"sourceType":"module"}